import"reflect-metadata";import{__extends as n}from"tslib";import t from"hoist-non-react-statics";import{Component as r,createContext as i,createElement as u,useContext as o,useEffect as e,useRef as f,useState as c,Fragment as a}from"react";var v=function(){function n(){this.handlers=[]}return n.prototype.on=function(n){return this.handlers.push(n),n},n.prototype.off=function(n){this.handlers=this.handlers.filter(function(t){return t!==n})},n.prototype.trigger=function(n){this.handlers.slice(0).forEach(function(t){return t(n)})},n}();function l(n){return"function"==typeof n}function s(n){return n&&"object"==typeof n}var b="function"==typeof Symbol?Symbol():"__injector__",h=i({}),d=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.t=new v,n}return n(r,t),r}(r);function m(n){var t,r=n[b];return r||((r=y||(null===(t=n.context)||void 0===t?void 0:t.injector))instanceof d?(n[b]=r,r):void 0)}var y=null;function p(n,t){for(_.length>0&&(_.forEach(function(n){n()}),_.length=0);n;){var r=n.i.get(t);if(void 0!==r)return r;var i=n.u.get(t);if(i){var u=y;y=n;try{r=i(n)}finally{y=u}return n.i.set(t,r),n.o(r),r}n=n.v}}var _=[];function j(n,t){if(l(t))return w(n,t);var r=n;return t?i(r,t):i;function i(n,t){n.constructor.contextType=h,r||(r=Reflect.getMetadata("design:type",n,t));var i={configurable:!0,enumerable:!0,get:function(){var n=w(this,r);return Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n}),n},set:function(n){Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n})}};return Object.defineProperty(n,t,i),i}}function w(n,t){return p(m(n),t)}var S="function"==typeof Symbol?Symbol():"__binding__";function g(n){return R(function(t){var r=new n;return r[b]||(r[b]=t),r})}function O(n,t){return R(t?function(r){return t.apply(void 0,n.map(function(n){return p(r,n)}))}:n)}function I(n){return R(function(){return n})}function M(n){return R(function(t){return p(t,n)})}function R(n){return n[S]=!0,n}function x(n,t){t.forEach(function(t){var r,i,u;"object"==typeof t&&t.token&&t.binding&&(i=t.token,u=t.binding),Array.isArray(t)?(i=t[0],u=void 0===(r=t[1])?i:r):i=u=t,n.set(i,u[S]?u:g(u))})}var A="function"==typeof Symbol?Symbol():"__init__",P=function(){return function(){}}(),k=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return function(i){var o=new Map;x(o,r);var e=function(t){function r(){var n,r=t.apply(this,arguments)||this;return r.v=null===(n=r.context)||void 0===n?void 0:n.injector,r.u=o,r.i=new Map,r.state={injector:r},r}return n(r,t),r.prototype.o=function(n){var t=this;n instanceof P&&!n[A]&&(n.initProvider(function(){t.setState({injector:t}),t.t.trigger()}),n[A]=!0)},r.prototype.componentDidMount=function(){var n=this;this.i.forEach(function(t){n.o(t)})},r.prototype.componentWillUnmount=function(){this.i.forEach(function(n){s(n)&&l(n.dispose)&&n.dispose()})},r.prototype.render=function(){return u(h.Provider,{value:this.state},u(i,this.props))},r.register=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];x(o,n)},r.WrappedComponent=i,r}(d);return e.contextType=h,t(e,i)}},q=function(n,t){return function(r){return _.push(function(){n().register(t?[r,t]:r)}),r}};function z(n){var t,r=f(void 0),i=null===(t=o(h))||void 0===t?void 0:t.injector,u=r.current||(r.current=p(i,n)),a=c({})[1];return e(function(){var t,r;if(i&&u&&!i.i.has(n))for(var o=i.v;o;)o.i.has(n)&&(r=o,t=o.t.on(function(){return a({})})),o=o.v;return function(){r&&r.t.off(t)}},[]),u}function B(){for(var n,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=f(null),u=null===(n=o(h))||void 0===n?void 0:n.injector,a=i.current||(i.current=t.map(function(n){return p(u,n)})),v=c({})[1];return e(function(){var n=[];return u&&t.forEach(function(t){if(!u.i.has(t))for(var r=u.v;r;)r.i.has(t)&&n.push({publisher:r,event:r.t.on(function(){return v({})})}),r=r.v}),function(){n.forEach(function(n){return n.publisher.t.off(n.event)})}},[]),a}var C=function(n){var t=n.children;return u(a,null,t)},D=function(n){var t=n.services,r=n.children,i=f(k.apply(void 0,t)(C));return u(i.current,null,r)};export{P as InjectedService,j as inject,k as provider,q as registerIn,j as Inject,k as Provider,q as RegisterIn,g as toClass,M as toExisting,O as toFactory,I as toValue,z as useInstance,B as useInstances,D as ComponentWithServices,v as LiteEventImpl};
//# sourceMappingURL=index.esm.min.js.map
