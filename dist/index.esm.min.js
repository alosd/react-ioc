import"reflect-metadata";import{__extends as n}from"tslib";import{createContext as t,Component as r,createElement as u,useRef as i,useContext as o,useState as e,useEffect as f,Fragment as c}from"react";import a from"hoist-non-react-statics";var v=function(){function n(){this.handlers=[]}return n.prototype.on=function(n){return this.handlers.push(n),n},n.prototype.off=function(n){this.handlers=this.handlers.filter(function(t){return t!==n})},n.prototype.trigger=function(n){this.handlers.slice(0).forEach(function(t){return t(n)})},n}();function l(n){return"function"==typeof n}function s(n){return n&&"object"==typeof n}var h="function"==typeof Symbol?Symbol():"__injector__",b=t({}),d=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.t=new v,n}return n(r,t),r}(r);function m(n){var t,r=n[h];return r||((r=p||(null===(t=n.context)||void 0===t?void 0:t.injector))instanceof d?(n[h]=r,r):void 0)}var p=null;function y(n,t){for(_.length>0&&(_.forEach(function(n){n()}),_.length=0);n;){var r=n.u.get(t);if(void 0!==r)return r;var u=n.i.get(t);if(u){var i=p;p=n;try{r=u(n)}finally{p=i}return n.u.set(t,r),n.o(r),r}n=n.v}}var _=[];function j(n,t){if(l(t))return w(n,t);var r=n;return t?u(r,t):u;function u(n,t){n.constructor.contextType=b,r||(r=Reflect.getMetadata("design:type",n,t));var u={configurable:!0,enumerable:!0,get:function(){var n=w(this,r);return Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n}),n},set:function(n){Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n})}};return Object.defineProperty(n,t,u),u}}function w(n,t){return y(m(n),t)}var S="function"==typeof Symbol?Symbol():"__binding__";function g(n){return R(function(t){var r=new n;return r[h]||(r[h]=t),r})}function O(n,t){return R(t?function(r){return t.apply(void 0,n.map(function(n){return y(r,n)}))}:n)}function I(n){return R(function(){return n})}function M(n){return R(function(t){return y(t,n)})}function R(n){return n[S]=!0,n}function x(n,t){t.forEach(function(t){var r,u,i;"object"==typeof t&&t.token&&t.binding&&(u=t.token,i=t.binding),Array.isArray(t)?(u=t[0],i=void 0===(r=t[1])?u:r):u=i=t,n.set(u,i[S]?i:g(i))})}var A="function"==typeof Symbol?Symbol():"__init__",P=function(){return function(){}}(),k=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(r){var i=new Map;x(i,t);var o=function(t){function o(){var n,r=this;return(r=t.apply(this,arguments)||this).v=null===(n=r.context)||void 0===n?void 0:n.injector,r.i=i,r.u=new Map,r.state={injector:r},r}return n(o,t),o.prototype.o=function(n){var t=this;n instanceof P&&!n[A]&&(n.initProvider(function(){t.setState({injector:t}),t.t.trigger()}),n[A]=!0)},o.prototype.componentDidMount=function(){var n=this;this.u.forEach(function(t){n.o(t)})},o.prototype.componentWillUnmount=function(){this.u.forEach(function(n){s(n)&&l(n.dispose)&&n.dispose()})},o.prototype.render=function(){return u(b.Provider,{value:this.state},u(r,this.props))},o.register=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];x(i,n)},o.WrappedComponent=r,o}(d);return o.contextType=b,a(o,r)}},q=function(n,t){return function(r){return _.push(function(){n().register(t?[r,t]:r)}),r}};function z(n){var t,r=i(void 0),u=null===(t=o(b))||void 0===t?void 0:t.injector,c=r.current||(r.current=y(u,n)),a=e({})[1],v=i({updater:a});return f(function(){var t,r;if(u&&c&&!u.u.has(n))for(var i=u.v;i;)i.u.has(n)&&(r=i,t=i.t.on(function(){return v.current.updater({})})),i=i.v;return function(){v.current.updater=function(){},r&&r.t.off(t)}},[]),c}function B(){for(var n,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var u=i(null),c=null===(n=o(b))||void 0===n?void 0:n.injector,a=u.current||(u.current=t.map(function(n){return y(c,n)})),v=e({})[1],l=i({updater:v});return f(function(){var n=[];return c&&t.forEach(function(t){if(!c.u.has(t))for(var r=c.v;r;)r.u.has(t)&&n.push({publisher:r,event:r.t.on(function(){return l.current.updater({})})}),r=r.v}),function(){l.current.updater=function(){},n.forEach(function(n){return n.publisher.t.off(n.event)})}},[]),a}var C=function(n){var t=n.children;return u(c,null,t)},D=function(n){var t=n.services,r=n.children,o=i(k.apply(void 0,t)(C));return u(o.current,null,r)};export{D as ComponentWithServices,j as Inject,P as InjectedService,v as LiteEventImpl,k as Provider,q as RegisterIn,j as inject,k as provider,q as registerIn,g as toClass,M as toExisting,O as toFactory,I as toValue,z as useInstance,B as useInstances};
//# sourceMappingURL=index.esm.min.js.map
