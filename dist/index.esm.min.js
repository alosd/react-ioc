import"reflect-metadata";import n from"hoist-non-react-statics";import{Component as t,createContext as i,createElement as r,useContext as o,useRef as u}from"react";import{__extends as e,__awaiter as f,__generator as c}from"tslib";import{createDraft as s,finishDraft as a,immerable as v}from"immer";export{original,enableES5,enableMapSet}from"immer";function h(n){return"function"==typeof n}function l(n){return n&&"object"==typeof n}var d="function"==typeof Symbol?Symbol():"__injector__",m=i({}),b=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return e(t,n),t}(t);function y(n){var t,i=n[d];return i||((i=_||(null===(t=n.context)||void 0===t?void 0:t.injector))instanceof b?(n[d]=i,i):void 0)}var _=null;function p(n,t){for(S.length>0&&(S.forEach(function(n){n()}),S.length=0);n;){var i=n.t.get(t);if(void 0!==i)return i;var r=n.i.get(t);if(r){var o=_;_=n;try{i=r(n)}finally{_=o}return n.t.set(t,i),n.o(i),i}n=n.u}}var S=[];function j(n,t){if(h(t))return w(n,t);var i=n;return t?r(i,t):r;function r(n,t){n.constructor.contextType=m,i||(i=Reflect.getMetadata("design:type",n,t));var r={configurable:!0,enumerable:!0,get:function(){var n=w(this,i);return Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n}),n},set:function(n){Object.defineProperty(this,t,{enumerable:!0,writable:!0,value:n})}};return Object.defineProperty(n,t,r),r}}function w(n,t){return p(y(n),t)}var g="function"==typeof Symbol?Symbol():"__binding__";function M(n){return R(function(t){var i=new n;return i[d]||(i[d]=t),i})}function O(n,t){return R(t?function(i){return t.apply(void 0,n.map(function(n){return p(i,n)}))}:n)}function x(n){return R(function(){return n})}function I(n){return R(function(t){return p(t,n)})}function R(n){return n[g]=!0,n}function A(n,t){t.forEach(function(t){var i,r,o;Array.isArray(t)?(r=t[0],o=void 0===(i=t[1])?r:i):r=o=t,n.set(r,o[g]?o:M(o))})}var E="function"==typeof Symbol?Symbol():"__init__",P=function(){return function(){}}(),k=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return function(i){var o=new Map;A(o,t);var u=function(n){function t(){var t,i=n.apply(this,arguments)||this;return i.u=null===(t=i.context)||void 0===t?void 0:t.injector,i.i=o,i.t=new Map,i}return e(t,n),t.prototype.o=function(n){var t=this;n instanceof P&&!n[E]&&(n.initProvider(function(){return t.setState({injector:t})}),n[E]=!0)},t.prototype.componentDidMount=function(){var n=this;this.t.forEach(function(t){n.o(t)})},t.prototype.componentWillUnmount=function(){this.t.forEach(function(n){l(n)&&h(n.dispose)&&n.dispose()})},t.prototype.render=function(){return r(m.Provider,{value:{injector:this}},r(i,this.props))},t.register=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];A(o,n)},t.WrappedComponent=i,t}(b);return u.contextType=m,n(u,i)}},q=function(n,t){return function(i){return S.push(function(){n().register(t?[i,t]:i)}),i}};function z(n){var t,i=u(void 0),r=null===(t=o(m))||void 0===t?void 0:t.injector;return i.current||(i.current=p(r,n))}function B(){for(var n,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=u(null),e=null===(n=o(m))||void 0===n?void 0:n.injector;return r.current||(r.current=t.map(function(n){return p(e,n)}))}var C="function"==typeof Symbol?Symbol():"__store__",D="function"==typeof Symbol?Symbol():"__stores__",F="function"==typeof Symbol?Symbol():"__refresh__",G=function(){function n(n){this.count=0,this.service=n}return n.prototype.start=function(n){var t,i=this;if(void 0===n&&(n=!0),0==this.count){var r=this.draft=null!==(t=this.draft)&&void 0!==t?t:s(this.service);this.service[D].forEach(function(n){i.service[n]=r[n]})}n&&this.count++},n.prototype.finish=function(n,t){var i=this;if(void 0===n&&(n=!0),void 0===t&&(t=!0),0==this.count)console.warn("the finish method must be called after corresponding start method");else if(t&&this.count--,0==this.count){var r=this.draft;if(r){this.service[D].forEach(function(n){r[n]=i.service[n]});var o=a(r);this.service[D].forEach(function(n){i.service[n]=o[n]}),this.draft=void 0}}n&&this.service.RefreshContext()},n}(),H=function(n){function t(){var t,i=n.call(this)||this;return i[D]=null!==(t=i[D])&&void 0!==t?t:[],i[v]=!0,i[C]=new G(i),i}return e(t,n),t.prototype.initProvider=function(n){this[F]=n,this[C].start(),this[C].finish()},t.prototype.RefreshContext=function(){this[F]&&this[F]()},t.prototype.waitForAsync=function(n){return f(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:this[C].finish(!0,!1),t.label=1;case 1:return t.trys.push([1,,3,4]),[4,n];case 2:return[2,t.sent()];case 3:return this[C].start(!1),[7];case 4:return[2]}})})},t}(P);function J(){return function(n,t){var i,r=n;r[D]=null!==(i=r[D])&&void 0!==i?i:[],r[D].push(t)}}var K=function(n,t){return f(void 0,void 0,void 0,function(){return c(this,function(i){switch(i.label){case 0:return i.trys.push([0,,2,3]),[4,t];case 1:return[2,i.sent()];case 2:return n[C].finish(),[7];case 3:return[2]}})})},L=function(n){return n&&"function"==typeof n.then};function N(){return function(n,t,i){var r=i.value;i.value=function(n){this[C].start();var t=!1;try{var i=r.call(this,n);return(t=L(i))?K(this,i):i}finally{t||this[C].finish()}}}}export{P as InjectedService,j as inject,k as provider,q as registerIn,j as Inject,k as Provider,q as RegisterIn,M as toClass,I as toExisting,O as toFactory,x as toValue,z as useInstance,B as useInstances,H as ImmutableService,N as action,J as store};
//# sourceMappingURL=index.esm.min.js.map
